function dcf = iterative_dcf_estimation(traj,varargin)
%Iteratively estimate density for arbitrary k-spaces in 3D. This code is
%downloaded from the ismrm-unbound website and written by Nick Zwart.

% Provide number of iter in varargin{1}
if ~isempty(varargin)
    n_iter=varargin{1};
end

kdim=size(traj);
for p=1:prod(kdim(5:end)) % Loop over partitions
    dcf(:,:,:,p)=sdc3_MAT(traj(:,:,:,p));
end

% END
end